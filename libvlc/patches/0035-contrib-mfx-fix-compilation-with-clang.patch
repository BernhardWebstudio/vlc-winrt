From d1497e8505a33ae7c0529f62bcb6bd4a1f65bf0d Mon Sep 17 00:00:00 2001
From: Steve Lhomme <robux4@ycbcr.xyz>
Date: Thu, 21 Mar 2019 09:12:03 +0100
Subject: [PATCH 35/37] contrib: mfx: fix compilation with clang

(cherry picked from commit 2c4b1e008f02b63ab2b290890d9a83fac1b3632e)
---
 contrib/src/mfx/mfx-cpp11-fix.patch | 20 ++++++++++++++++++++
 contrib/src/mfx/rules.mak           |  1 +
 2 files changed, 21 insertions(+)
 create mode 100644 contrib/src/mfx/mfx-cpp11-fix.patch

diff --git a/contrib/src/mfx/mfx-cpp11-fix.patch b/contrib/src/mfx/mfx-cpp11-fix.patch
new file mode 100644
index 0000000000..dff7503376
--- /dev/null
+++ b/contrib/src/mfx/mfx-cpp11-fix.patch
@@ -0,0 +1,20 @@
+--- mfx/src/mfx_plugin_hive.cpp.cpp11	2019-03-20 09:52:12.000000000 +0100
++++ mfx/src/mfx_plugin_hive.cpp	2019-03-21 09:08:20.825840300 +0100
+@@ -169,7 +169,7 @@ MFX::MFXPluginsInHive::MFXPluginsInHive(
+ 
+         if (QueryKey(subKey, CodecIDKeyName, descriptionRecord.CodecId))
+         {
+-            TRACE_HIVE_INFO(alignStr()" : "MFXFOURCCTYPE()" \n", CodecIDKeyName, MFXU32TOFOURCC(descriptionRecord.CodecId));
++            TRACE_HIVE_INFO(alignStr()" : " MFXFOURCCTYPE() " \n", CodecIDKeyName, MFXU32TOFOURCC(descriptionRecord.CodecId));
+         }
+         else
+         {
+@@ -180,7 +180,7 @@ MFX::MFXPluginsInHive::MFXPluginsInHive(
+         {
+             continue;
+         }
+-        TRACE_HIVE_INFO(alignStr()" : "MFXGUIDTYPE()"\n", GUIDKeyName, MFXGUIDTOHEX(&descriptionRecord.PluginUID));
++        TRACE_HIVE_INFO(alignStr()" : " MFXGUIDTYPE() "\n", GUIDKeyName, MFXGUIDTOHEX(&descriptionRecord.PluginUID));
+ 
+         mfxU32 nSize = sizeof(descriptionRecord.sPath)/sizeof(*descriptionRecord.sPath);
+         if (!subKey.Query(PathKeyName, descriptionRecord.sPath, nSize))
diff --git a/contrib/src/mfx/rules.mak b/contrib/src/mfx/rules.mak
index bef7aa37a6..510383e786 100644
--- a/contrib/src/mfx/rules.mak
+++ b/contrib/src/mfx/rules.mak
@@ -27,6 +27,7 @@ $(TARBALLS)/mfx-$(MFX_GITHASH).tar.xz:
 
 mfx: mfx-$(MFX_GITHASH).tar.xz .sum-mfx
 	$(UNPACK)
+	$(APPLY) $(SRC)/mfx/mfx-cpp11-fix.patch
 	cd $(UNPACK_DIR) && autoreconf -ivf
 	$(MOVE)
 
-- 
2.26.0.windows.1

